---
sidebar: 'auto'
prev: /zh/harvest/overview.md
next: /zh/harvest/mysql/index.md

---

# 字段使用原则

- `id` 必须是主键，每个表必须有主键，且保持增长趋势的，小型系统可以依赖于 `MySQL` 的自增主键，大型系统或者需要分库分表时才使用内置的 `ID` 生成器。
- 字段尽量使用 `DEFAULT NOT NULL`，应该给该字段类型的一个默认值。
- `create_time` 和 `modify_time` 最好使用 `datetime`，一个是时间长度比 `timestamp` 长一些，其次我们不应该让数据库自己写入当前时间，而是程序写入。
- 定长字段请使用 `char`，例如用户的唯一ID，一般是指定长度且唯一。
- 枚举类型字段使用 `enum`，且不应该是 `10`、`20`...这种，应该是具体的意义的字段，例如：`active`、`freeze`、`ban`。
- `varchar` 是可变长字符串，不预先分配存储空间，长度不要超过5000，如果存储长度大于此值，定义字段类型为 `text`，独立出来一张表，用主键来对应，避免影响其它字段索引效率。
- 小数类型为`decimal`，禁止使用 `float` 和 `double`；会存在精度丢失问题。

## 整型

- `TINYINT`
  - 1字节
  - 长度范围: -2^7 (-127) ~ 2^7-1 (127) 或者 0 ~ 2^8 (255)
- `SMALLINT`
  - 2字节
  - 长度范围: -2^15 (-32768) ~ 2^15-1 (32767) 或者 0 ~ 2^16-1 (65535)
- `MEDIUMINT`
  - 3字节
  - 长度范围: -2^31 (-8388608) ~ 2^23-1 (8388607) 或者 0 ~ 2^24-1 (16777215)
- `INT`
  - 4字节
  - 长度范围: -2^31 (-2147483648) ~ 2^31-1 (2147483647) 或者 0 ~ 2^32-1 (4294967295)
- `BIGINT`
  - 8字节
  - 长度范围: -2^63 (-9223372036854775808) ~ 2^63-1 (9223372036854775807) 或者 0 ~ 2^64-1 (18446744073709551615)

---

- 根据业务判断是否是 `unsigned`，无负数时，使用该约束。
- 设置长度(int(11)或者int(4))并无明显意义，只是影响显示位宽，因为类型已经决定了可以表示的数值的大小。
- 时间需要比较大小或者有索引时，可以使用 `int` 类型 表示时间戳，较早前会这么设计。

---

## 字符串类型

- 固定长度使用 `char` ;非固定长度使用 `varchar` 。
- `VARCHAR`: 最大长度为65532个字节，Exp: varchar(20)指的是20字符，无论存放的是数字、
字母还是UTF8汉字，都可以存放20个，最大大小是65532字节。
- `CHAR`: char最多可以存放255个字节，Exp: char(20)指的是20字符，无论存放的是数字、
  字母还是UTF8汉字，都可以存放20个，最大大小是255字节。

::: tip
utf8编码中，一个英文字符等于一个字节，一个中文（含繁体）等于三个字节；utf8mb4字符集中一个汉字占4个字节
:::